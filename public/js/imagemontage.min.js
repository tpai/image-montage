"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(function(a){"use strict";var _class,_temp,_initialiseProps;a.ImageMontage=(_temp=_class=function _class(c){_classCallCheck(this,_class),_initialiseProps.call(this),this.rootId=c||"#container"},_initialiseProps=function _initialiseProps(){var _this=this;this.initBricks=function(c){var d=["lightblue","lightcyan","lightcoral","lightpink","lightgrey","lightgreen","lightsalmon","lightskyblue","lightseagreen"],e=1,f=1,g="",j="";// add empty brick as placeholder
for(var k=0;35>k;++k)f=1+2*Math.random()<<0,e=2+2*Math.random()<<0,j=d[d.length*Math.random()<<0],g+="\n                    <div class='brick' style='width:"+150*e+"px; height: "+150*f+"px; background-color: "+j+"'>\n                        <div class='cover'></div>\n                    </div>\n                ";$(_this.rootId).html(g),_this.freewall(),_this.displayImages(c)},this.preloadImage=function(c){$("#preload").html(""),_.map(c,function(d){$("#preload").append("<img src='"+d+"' />")})},this.fixImageSize=function(c){var d=c.target,e=c.parent,f=c.child,g=parseInt(e.width,10),j=parseInt(e.height,10),k=parseInt(f.width,10),l=parseInt(f.height,10);l*g/k<j?$(d).attr("style","height: "+j+"px"):$(d).attr("style","width: "+g+"px")},this.freewall=function(){var c=new Freewall(_this.rootId);c.reset({selector:".brick",cellW:160,cellH:160,gutterX:15,gutterY:15,onResize:function onResize(){c.fitZone($(a).width()-30,$(a).height()-30)},onComplete:function onComplete(){$.each($(".brick img"),function(d,e){var f=$(e);_this.fixImageSize({target:f,parent:{width:f.parent().css("width"),height:f.parent().css("height")},child:{width:f.css("width"),height:f.css("height")}})})}}),c.fitZone($(a).width()-30,$(a).height()-30)},this.displayImages=function(c){var d=_.filter(_.map(c,function(g){if(g.type)return g.link}),function(g){return g!==void 0});_this.preloadImage(d);var e=$(".cover"),f=setInterval(function(){var g=$(e.splice(0,1)),j=parseInt(g.parent().css("width"),10),k=parseInt(g.parent().css("height"),10),l=$("<img src='"+d.shift()+"' class='cover' />").load(function(){// natural width and height of image
var m=l.prop("naturalWidth"),n=l.prop("naturalHeight");g.parent().fadeOut(500,function(){g.replaceWith(l),_this.fixImageSize({target:l,parent:{width:j,height:k},child:{width:m,height:n}})}).fadeIn(500)});// width and height of brick
0===e.length&&clearInterval(f)},3000)}},_temp)})(window);
